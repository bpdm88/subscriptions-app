(this["webpackJsonpsubscription-app"]=this["webpackJsonpsubscription-app"]||[]).push([[0],{33:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),r=n.n(c),i=n(11),s=n.n(i),l=(n(33),n(6)),o=n(7),u=n(2),d=n(9),h=n(8),b=function(e){var t=e.colourCode;return Object(a.jsx)("div",{className:{1:"traffic-light--green",2:"traffic-light--yellow",3:"traffic-light--red"}[t]})},j=function(e){var t=new Date;return e>t.getDate()?t.setDate(e):(t.setDate(e),t.setMonth(t.getMonth()+1),t)},O=function(e,t){return function(e){var t=e/864e5;return Math.floor(t)}(function(e,t){var n=1e3*e*60*60*24,a=new Date,c=new Date(t-n);return c-a>=0||c.setMonth(c.getMonth()+1),c}(e,j(t))-new Date)},p=function(e,t){var n,a,c=function(e){var t=e.toString(),n=+t.substring(0,4),a=+t.substring(4,6),c=+t.substring(6,8);return new Date(n,a-1,c)}(e),r=new Date;return(n=c,12*((a=r).getFullYear()-n.getFullYear())+(a.getMonth()-n.getMonth()))*t},f=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleDelete=a.handleDelete.bind(Object(u.a)(a)),a}return Object(o.a)(n,[{key:"handleDelete",value:function(e){e.preventDefault(),window.confirm("Do you want to delete this subscription?")&&this.props.deleteItem(this.props.itemID)}},{key:"render",value:function(){return Object(a.jsx)("button",{onClick:this.handleDelete,className:"delete",children:"Delete Subscription"})}}]),n}(c.Component),m=n(5),g=n(26),C=n.n(g).a.create({baseURL:"https://subscriptions-tracker.developme.space/api/subscriptions",headers:{Accept:"application/json"}}),v=Object(m.b)(null,(function(e){return{deleteItem:function(t){return e(function(e){return function(t){C.delete("/".concat(e)).then((function(){t(function(e){return{type:"DELETE",id:e}}(e))}))}}(t))}}}))(f),y=function(e){var t=e.selected;return Object(a.jsx)("ul",{className:"categories-list",children:t.categories.map((function(e,t){return Object(a.jsx)("li",{className:"category",children:e},t)}))})},x=function(e){var t=e.selected,n=e.listID;return t&&t.id===n?Object(a.jsxs)("div",{className:"card-items",children:[Object(a.jsxs)("p",{children:["Monthly Cost: \xa3",t.cost]}),Object(a.jsx)("p",{children:"Next payment date: "}),Object(a.jsxs)("p",{children:["Spent so far: \xa3",p(t.start,+t.cost)]}),Object(a.jsxs)("p",{children:["Cancel in: ",O(t.notice_period,t.payment_date)," days"]}),Object(a.jsx)(y,{selected:t}),Object(a.jsx)(v,{className:"delete",itemID:n})]}):null},S=Object(m.b)((function(e){var t=e.subscriptions.filter((function(t){return t.id===e.selected}));return{selected:0===t.length?null:t[0]}}))(x),D=n(3),k=function(e){var t=e.label,n=e.name,c=e.type,r=e.handleChange,i=e.value,s=e.min,l=e.max;return Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{htmlFor:n,children:t}),Object(a.jsx)("input",{className:"input",id:n,type:c,onChange:r,value:i,min:s,max:l})]})},N=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={name:"",cost:0,startDate:null,paymentDate:0,notice:0,categories:[]},a.handleSubmit=a.handleSubmit.bind(Object(u.a)(a)),a.handleChangeName=a.handleChangeName.bind(Object(u.a)(a)),a.handleChangeCost=a.handleChangeCost.bind(Object(u.a)(a)),a.handleChangeStart=a.handleChangeStart.bind(Object(u.a)(a)),a.handleChangePayment=a.handleChangePayment.bind(Object(u.a)(a)),a.handleChangeNotice=a.handleChangeNotice.bind(Object(u.a)(a)),a.handleChangeCategories=a.handleChangeCategories.bind(Object(u.a)(a)),a}return Object(o.a)(n,[{key:"handleSubmit",value:function(e){var t=this.state;t.name,t.cost,t.startDate,t.paymentDate,t.notice,t.categories;e.preventDefault(),this.props.handleAddSubscription(Object(D.a)({},this.state)),this.setState({name:"",cost:null,startDate:"",paymentDate:null,notice:null,categories:[]})}},{key:"handleChangeName",value:function(e){this.setState({name:e.currentTarget.value})}},{key:"handleChangeCost",value:function(e){this.setState({cost:e.currentTarget.value})}},{key:"handleChangeStart",value:function(e){this.setState({startDate:e.currentTarget.value})}},{key:"handleChangePayment",value:function(e){var t;t=e.currentTarget.value>31?31:e.currentTarget.value<1?1:e.currentTarget.value,this.setState({paymentDate:t})}},{key:"handleChangeNotice",value:function(e){this.setState({notice:e.currentTarget.value})}},{key:"handleChangeCategories",value:function(e){this.setState({categories:e.currentTarget.value})}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.cost,c=e.startDate,r=e.paymentDate,i=e.notice,s=e.categories;return this.props.form?Object(a.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(a.jsx)(k,{label:"Name",name:"Name",type:"text",handleChange:this.handleChangeName,value:t}),Object(a.jsx)(k,{label:"Cost",name:"Cost",type:"number",handleChange:this.handleChangeCost,value:n}),Object(a.jsx)(k,{label:"Start Date",name:"Start Date",type:"date",handleChange:this.handleChangeStart,value:c}),Object(a.jsx)(k,{label:"Payment Date",name:"Payment Date",type:"number",min:"1",max:"31",handleChange:this.handleChangePayment,value:r}),Object(a.jsx)(k,{label:"Notice Period",name:"Notice Period",type:"number",handleChange:this.handleChangeNotice,value:i}),Object(a.jsx)(k,{label:"Categories",name:"Categories",type:"text",handleChange:this.handleChangeCategories,value:s}),Object(a.jsx)("button",{className:"form-button",children:"Add Subscription"})]}):null}}]),n}(r.a.Component),T=Object(m.b)((function(e){return{form:e.form}}),(function(e){return{handleAddSubscription:function(t){return e(function(e){return function(t){C.post("/",{subscription_name:e.name,cost:e.cost,start:e.startDate.replace(/-/g,""),payment_date:e.paymentDate,notice_period:e.notice,categories:e.categories.split(", ")}).then((function(e){var n=e.data;t(function(e){return{type:"SAVE_SUBSCRIPTION",data:e}}(n.data))}))}}(t))}}}))(N),E=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).catListInFilterList=function(e,t){return e.reduce((function(e,n){return!!t.includes(n)||e}),!1)},a.handleClick=a.handleClick.bind(Object(u.a)(a)),a.whatColour=a.whatColour.bind(Object(u.a)(a)),a.formClick=a.formClick.bind(Object(u.a)(a)),a.catListInFilterList=a.catListInFilterList.bind(Object(u.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.handleLoad()}},{key:"handleClick",value:function(e){this.props.setSelected(e.currentTarget.dataset.id)}},{key:"formClick",value:function(){this.props.displayForm()}},{key:"whatColour",value:function(e){var t=((j(e)-new Date)/864e5).toFixed(1);return t<=5?3:t<=10?2:1}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,c=t.categoryFilter,r=[];return r=0===c.length?n:n.filter((function(t){return e.catListInFilterList(t.categories,c)})),Object(a.jsxs)("ul",{className:"sub-card",children:[r.map((function(t){return Object(a.jsxs)("li",{"data-id":t.id,className:"list-item",children:[Object(a.jsxs)("div",{onClick:e.handleClick,"data-id":t.id,className:"list-item_header",children:[Object(a.jsx)("p",{children:t.subscription_name}),Object(a.jsx)(b,{colourCode:e.whatColour(t.payment_date)})]}),Object(a.jsx)(S,{listID:t.id})]},t.id)})),Object(a.jsxs)("li",{className:"list-item",children:["Add Subscription",Object(a.jsx)("button",{class:"add",onClick:this.formClick,children:"+"}),Object(a.jsx)(T,{})]})]})}}]),n}(c.Component),_=Object(m.b)((function(e){return{list:e.subscriptions,categoryFilter:e.categoryFilter}}),(function(e){return{setSelected:function(t){return e(function(e){return{type:"SET_SELECTED",selected:e}}(t))},handleLoad:function(){return e((function(e){C.get("/").then((function(t){var n=t.data.data;e({type:"STORE_SUBSCRIPTIONS",data:n})}))}))},displayForm:function(){return e({type:"SET_FORM"})}}}))(E),F=n.p+"static/media/logo.5bbf18a7.svg",I=function(){return Object(a.jsxs)("header",{children:[Object(a.jsx)("div",{children:Object(a.jsx)("img",{className:"logo-svg",src:F,alt:"My Subscriptions Logo"})}),Object(a.jsx)("ul",{children:Object(a.jsx)("li",{children:"API Documents"})})]})},w=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleClick=a.handleClick.bind(Object(u.a)(a)),a}return Object(o.a)(n,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.categoryClick(e.currentTarget.innerText)}},{key:"render",value:function(){var e=this,t=this.props.categories;return Object(a.jsxs)("div",{class:"dropdown",children:[Object(a.jsx)("button",{class:"dropbtn",children:"Catagories"}),Object(a.jsxs)("div",{class:"dropdown-content",children:[Object(a.jsx)("button",{onClick:this.handleClick,children:"Clear"}),t?this.props.categories.map((function(t){return Object(a.jsx)("button",{onClick:e.handleClick,children:t},t)})):"Loading...."]})]})}}]),n}(c.Component),L=function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(I,{}),Object(a.jsx)(_,{}),Object(a.jsx)(w,{})]})},M=n(10),P=n(27),R={subscriptions:[],loaded:!1,selected:null,form:!0,categoryFilter:[]},A=n(12),U=function(e,t){switch(t.type){case"STORE_SUBSCRIPTIONS":return function(e,t){var n=t.data;return Object(D.a)(Object(D.a)({},e),{},{subscriptions:n})}(e,t);case"SET_SELECTED":return function(e,t){var n=t.selected;return console.log(typeof n),console.log(n===e.selected),Object(D.a)(Object(D.a)({},e),{},{selected:+n===e.selected?0:+n})}(e,t);case"SET_FORM":return function(e){return Object(D.a)(Object(D.a)({},e),{},{form:!e.form})}(e);case"SAVE_SUBSCRIPTION":return function(e,t){var n=t.data;return Object(D.a)(Object(D.a)({},e),{},{subscriptions:[].concat(Object(A.a)(e.subscriptions),[n])})}(e,t);case"DELETE":return function(e,t){var n=t.id,a=e.subscriptions.filter((function(e){return e.id!==n}));return Object(D.a)(Object(D.a)({},e),{},{subscriptions:Object(A.a)(a)})}(e,t);case"ADD_CAT_FILTER":return function(e,t){var n=t.category;return e.categoryFilter.includes(n)?Object(D.a)({},e):Object(D.a)(Object(D.a)({},e),{},{categoryFilter:[].concat(Object(A.a)(e.categoryFilter),[n])})}(e,t);case"CLEAR_CAT_FILTER":return function(e){return Object(D.a)(Object(D.a)({},e),{},{categoryFilter:[]})}(e);default:return e}},B=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||M.c,V=Object(M.d)(U,R,B(Object(M.a)(P.a)));s.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(m.a,{store:V,children:Object(a.jsx)(L,{})})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.9d8d4e80.chunk.js.map