(this["webpackJsonpsubscription-app"]=this["webpackJsonpsubscription-app"]||[]).push([[0],{33:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(1),c=n.n(r),i=n(12),s=n.n(i),o=(n(33),n(6)),l=n(7),u=n(3),d=n(9),b=n(8),h=function(e){var t=e.colourCode;return Object(a.jsx)("div",{className:{1:"traffic-light--green",2:"traffic-light--yellow",3:"traffic-light--red"}[t]})},j=function(e){var t=e/864e5;return Math.floor(t)},p=function(e){var t=new Date;return e>t.getDate()?(t.setDate(e),t):(t.setDate(e),t.setMonth(t.getMonth()+1),t)},f=function(e){var t=p(e);console.log(t);var n=t.getDate(),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()];return"".concat(n).concat(function(e){switch(e){case 1:return"st";case 2:return"nd";case 3:return"rd";case 21:return"st";case 22:return"nd";case 23:return"rd";case 31:return"st";default:return"th"}}(n)," ").concat(a)},O=function(e,t){var n=1e3*e*60*60*24,a=new Date,r=new Date(t-n);if(r-a>=0)return r;var c=Math.ceil(j(a-r)/365*12);return r.setMonth(r.getMonth()+c),r},C=function(e,t){var n=p(t),a=O(e,n),r=new Date;return j(a-r)},m=function(e,t){var n,a,r=function(e){var t=e.toString(),n=+t.substring(0,4),a=+t.substring(4,6),r=+t.substring(6,8);return new Date(n,a-1,r)}(e),c=new Date;return(n=r,12*((a=c).getFullYear()-n.getFullYear())+(a.getMonth()-n.getMonth()))*t},g=function(e){Object(d.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleDelete=a.handleDelete.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"handleDelete",value:function(e){e.preventDefault(),window.confirm("Do you want to delete this subscription?")&&this.props.deleteItem(this.props.itemID)}},{key:"render",value:function(){return Object(a.jsx)("button",{onClick:this.handleDelete,className:"delete",children:"Delete Subscription"})}}]),n}(r.Component),v=n(4),y=n(26),D=n.n(y).a.create({baseURL:"https://subscriptions-tracker.developme.space/api/subscriptions",headers:{Accept:"application/json"}}),k=Object(v.b)(null,(function(e){return{deleteItem:function(t){return e(function(e){return function(t){D.delete("/".concat(e)).then((function(){t(function(e){return{type:"DELETE",id:e}}(e))}))}}(t))}}}))(g),x=function(e){var t=e.selected;return Object(a.jsx)("ul",{className:"categories-list",children:t.categories.map((function(e,t){return Object(a.jsx)("li",{className:"category",children:e},t)}))})},_=function(e){var t=e.selected,n=e.listID;return t&&t.id===n?Object(a.jsxs)("div",{className:"card-items",children:[Object(a.jsxs)("p",{children:["Monthly Cost: \xa3",t.cost]}),Object(a.jsxs)("p",{children:["Next payment date: ",f(t.payment_date)]}),Object(a.jsxs)("p",{children:["Spent so far: \xa3",m(t.start,+t.cost)]}),Object(a.jsxs)("p",{children:["Cancel in: ",C(t.notice_period,t.payment_date)," days"]}),Object(a.jsx)(x,{selected:t}),Object(a.jsx)(k,{className:"delete",itemID:n})]}):null},S=Object(v.b)((function(e){var t=e.subscriptions.filter((function(t){return t.id===e.selected}));return{selected:0===t.length?null:t[0]}}))(_),E=n(2),T=function(e){var t=e.label,n=e.name,r=e.type,c=e.handleChange,i=e.value,s=e.min,o=e.max;return Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{htmlFor:n,children:t}),Object(a.jsx)("input",{className:"input",id:n,type:r,onChange:c,value:i,min:s,max:o})]})},w=function(e){Object(d.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={name:"",cost:0,startDate:null,paymentDate:0,notice:0,categories:[]},a.handleSubmit=a.handleSubmit.bind(Object(u.a)(a)),a.handleChangeName=a.handleChangeName.bind(Object(u.a)(a)),a.handleChangeCost=a.handleChangeCost.bind(Object(u.a)(a)),a.handleChangeStart=a.handleChangeStart.bind(Object(u.a)(a)),a.handleChangePayment=a.handleChangePayment.bind(Object(u.a)(a)),a.handleChangeNotice=a.handleChangeNotice.bind(Object(u.a)(a)),a.handleChangeCategories=a.handleChangeCategories.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"handleSubmit",value:function(e){var t=this.state;t.name,t.cost,t.startDate,t.paymentDate,t.notice,t.categories;e.preventDefault(),this.props.handleAddSubscription(Object(E.a)({},this.state)),this.setState({name:"",cost:null,startDate:"",paymentDate:null,notice:null,categories:[]})}},{key:"handleChangeName",value:function(e){this.setState({name:e.currentTarget.value})}},{key:"handleChangeCost",value:function(e){this.setState({cost:e.currentTarget.value})}},{key:"handleChangeStart",value:function(e){this.setState({startDate:e.currentTarget.value})}},{key:"handleChangePayment",value:function(e){var t;t=e.currentTarget.value>31?31:e.currentTarget.value<1?1:e.currentTarget.value,this.setState({paymentDate:t})}},{key:"handleChangeNotice",value:function(e){this.setState({notice:e.currentTarget.value})}},{key:"handleChangeCategories",value:function(e){this.setState({categories:e.currentTarget.value})}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.cost,r=e.startDate,c=e.paymentDate,i=e.notice,s=e.categories;return this.props.form?Object(a.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(a.jsx)(T,{label:"Name",name:"Name",type:"text",handleChange:this.handleChangeName,value:t}),Object(a.jsx)(T,{label:"Cost",name:"Cost",type:"number",handleChange:this.handleChangeCost,value:n}),Object(a.jsx)(T,{label:"Start Date",name:"Start Date",type:"date",handleChange:this.handleChangeStart,value:r}),Object(a.jsx)(T,{label:"Payment Date",name:"Payment Date",type:"number",min:"1",max:"31",handleChange:this.handleChangePayment,value:c}),Object(a.jsx)(T,{label:"Notice Period",name:"Notice Period",type:"number",handleChange:this.handleChangeNotice,value:i}),Object(a.jsx)(T,{label:"Categories",name:"Categories",type:"text",handleChange:this.handleChangeCategories,value:s}),Object(a.jsx)("button",{className:"form-button",children:"Add Subscription"})]}):null}}]),n}(c.a.Component),N=Object(v.b)((function(e){return{form:e.form}}),(function(e){return{handleAddSubscription:function(t){return e(function(e){return function(t){D.post("/",{subscription_name:e.name,cost:e.cost,start:e.startDate.replace(/-/g,""),payment_date:e.paymentDate,notice_period:e.notice,categories:"string"===typeof e.categories?e.categories.split(", "):[]}).then((function(e){var n=e.data;t(function(e){return{type:"SAVE_SUBSCRIPTION",data:e}}(n.data))}))}}(t))}}}))(w),L=function(e){Object(d.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).catListInFilterList=function(e,t){return e.reduce((function(e,n){return!!t.includes(n)||e}),!1)},a.handleClick=a.handleClick.bind(Object(u.a)(a)),a.whatColour=a.whatColour.bind(Object(u.a)(a)),a.formClick=a.formClick.bind(Object(u.a)(a)),a.catListInFilterList=a.catListInFilterList.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.handleLoad()}},{key:"handleClick",value:function(e){this.props.setSelected(e.currentTarget.dataset.id)}},{key:"formClick",value:function(){this.props.displayForm()}},{key:"whatColour",value:function(e){var t=((p(e)-new Date)/864e5).toFixed(1);return t<=5?3:t<=10?2:1}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,r=t.categoryFilter,c=(t.form,[]);return c=0===r.length?n:n.filter((function(t){return e.catListInFilterList(t.categories,r)})),Object(a.jsxs)("ul",{className:"sub-card",children:[c.map((function(t){return Object(a.jsxs)("li",{"data-id":t.id,className:"list-item",children:[Object(a.jsxs)("div",{onClick:e.handleClick,"data-id":t.id,className:"list-item_header",children:[Object(a.jsx)("p",{children:t.subscription_name}),Object(a.jsx)(h,{colourCode:e.whatColour(t.payment_date)})]}),Object(a.jsx)(S,{listID:t.id})]},t.id)})),Object(a.jsxs)("li",{className:"list-item",children:[Object(a.jsx)("p",{className:"add-sub-text",onClick:this.formClick,children:"Add Subscription"}),Object(a.jsx)(N,{})]})]})}}]),n}(r.Component),F=Object(v.b)((function(e){return{list:e.subscriptions,categoryFilter:e.categoryFilter,form:e.form}}),(function(e){return{setSelected:function(t){return e(function(e){return{type:"SET_SELECTED",selected:e}}(t))},handleLoad:function(){return e((function(e){D.get("/").then((function(t){var n=t.data.data;e({type:"STORE_SUBSCRIPTIONS",data:n})}))}))},displayForm:function(){return e({type:"SET_FORM"})}}}))(L),I=n.p+"static/media/logo.5bbf18a7.svg",R=function(){return Object(a.jsxs)("header",{children:[Object(a.jsx)("div",{children:Object(a.jsx)("img",{className:"logo-svg",src:I,alt:"My Subscriptions Logo"})}),Object(a.jsx)("ul",{children:Object(a.jsx)("li",{children:Object(a.jsx)("a",{href:"https://github.com/ammersive/subscription-tracker-bk/blob/main/README.md",target:"_blank",rel:"noreferrer",children:"About"})})})]})},P=n(10),A=function(e){Object(d.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleClick=a.handleClick.bind(Object(u.a)(a)),a.handleDropDown=a.handleDropDown.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.categoryClick(e.currentTarget.innerText)}},{key:"handleDropDown",value:function(e){e.preventDefault(),this.props.dropDownClick()}},{key:"render",value:function(){var e=this,t=this.props,n=t.categories,r=t.dropDownContent,c=t.selectedCategories;return Object(a.jsxs)("div",{class:"dropdown",children:[Object(a.jsx)("button",{class:"dropbtn",onClick:this.handleDropDown,children:"Catagories"}),r?Object(a.jsxs)("div",{class:"dropdown-content",children:[Object(a.jsx)("button",{onClick:this.handleClick,children:"Clear"}),n?this.props.categories.map((function(t){return Object(a.jsx)("button",{id:c.includes(t)?"selectedCat":"",onClick:e.handleClick,children:t},t)})):"Loading...."]}):null]})}}]),n}(r.Component),M=Object(v.b)((function(e){return{categories:e.subscriptions.reduce((function(e,t){var n=t.categories.filter((function(t){return!e.includes(t)}));return e.push.apply(e,Object(P.a)(n)),e}),[]),dropDownContent:e.dropDown,selectedCategories:e.categoryFilter}}),(function(e){return{categoryClick:function(t){return e(function(e){return"Clear"===e?{type:"CLEAR_CAT_FILTER"}:{type:"ADD_CAT_FILTER",category:e}}(t))},dropDownClick:function(t){return e({type:"TOGGLE_DROP_DOWN"})}}}))(A),B=function(e){Object(d.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleDropDown=a.handleDropDown.bind(Object(u.a)(a)),a.handleClickPayment=a.handleClickPayment.bind(Object(u.a)(a)),a.handleClickCancel=a.handleClickCancel.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"handleClickPayment",value:function(e){e.preventDefault(),this.props.filterPaymentClicked()}},{key:"handleClickCancel",value:function(e){e.preventDefault(),this.props.filterCancelClicked()}},{key:"handleDropDown",value:function(e){e.preventDefault(),this.props.filterClick()}},{key:"render",value:function(){var e=this.props,t=e.filterContent;return e.dropDown?null:Object(a.jsxs)("div",{class:"dropdown",children:[Object(a.jsx)("button",{class:"dropbtn",onClick:this.handleDropDown,children:"Sort"}),t?Object(a.jsxs)("div",{className:"dropdown-content sort-background",children:[Object(a.jsx)("button",{className:"adjustment",onClick:this.handleClickPayment,children:"Payment day"}),Object(a.jsx)("button",{className:"adjustment",onClick:this.handleClickCancel,children:"Cancel day"})]}):null]})}}]),n}(r.Component),G=Object(v.b)((function(e){return{filterContent:e.filterContent,dropDown:e.dropDown}}),(function(e){return{filterPaymentClicked:function(){return e({type:"FILTER_BY_PAYMENT"})},filterCancelClicked:function(){return e({type:"FILTER_BY_CANCEL"})},filterClick:function(){return e({type:"TOGGLE_FILTER"})}}}))(B),Y=function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(R,{}),Object(a.jsx)(M,{}),Object(a.jsx)(G,{}),Object(a.jsx)(F,{})]})},U=n(11),J=n(27),V={subscriptions:[{id:1,subscription_name:"Loading....",payment_date:(new Date).getDate(),categories:[]}],loaded:!1,selected:null,form:!1,categoryFilter:[],dropDown:!1,filterContent:!1},W=function(e,t){switch(t.type){case"STORE_SUBSCRIPTIONS":return function(e,t){var n=t.data;return Object(E.a)(Object(E.a)({},e),{},{subscriptions:n})}(e,t);case"SET_SELECTED":return function(e,t){var n=t.selected;return Object(E.a)(Object(E.a)({},e),{},{selected:+n===e.selected?0:+n})}(e,t);case"SET_FORM":return function(e){return Object(E.a)(Object(E.a)({},e),{},{form:!e.form})}(e);case"SAVE_SUBSCRIPTION":return function(e,t){var n=t.data;return Object(E.a)(Object(E.a)({},e),{},{subscriptions:[].concat(Object(P.a)(e.subscriptions),[n])})}(e,t);case"DELETE":return function(e,t){var n=t.id,a=e.subscriptions.filter((function(e){return e.id!==n}));return Object(E.a)(Object(E.a)({},e),{},{subscriptions:Object(P.a)(a)})}(e,t);case"ADD_CAT_FILTER":return function(e,t){var n=t.category;return e.categoryFilter.includes(n)?Object(E.a)({},e):Object(E.a)(Object(E.a)({},e),{},{categoryFilter:[].concat(Object(P.a)(e.categoryFilter),[n])})}(e,t);case"CLEAR_CAT_FILTER":return function(e){return Object(E.a)(Object(E.a)({},e),{},{categoryFilter:[]})}(e);case"TOGGLE_DROP_DOWN":return function(e){return Object(E.a)(Object(E.a)({},e),{},{dropDown:!e.dropDown,filterContent:!1})}(e);case"TOGGLE_FILTER":return function(e){return Object(E.a)(Object(E.a)({},e),{},{filterContent:!e.filterContent})}(e);case"FILTER_BY_PAYMENT":return function(e){var t=e.subscriptions.sort((function(e,t){return p(e.payment_date)-p(t.payment_date)})),n=Object(P.a)(t);return Object(E.a)(Object(E.a)({},e),{},{subscriptions:n})}(e);case"FILTER_BY_CANCEL":return function(e){var t=e.subscriptions.sort((function(e,t){return O(e.notice_period,p(e.payment_date))-O(t.notice_period,p(t.payment_date))})),n=Object(P.a)(t);return Object(E.a)(Object(E.a)({},e),{},{subscriptions:n})}(e);default:return e}},X=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||U.c,q=Object(U.d)(W,V,X(Object(U.a)(J.a)));s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(v.a,{store:q,children:Object(a.jsx)(Y,{})})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.fe64a1c8.chunk.js.map